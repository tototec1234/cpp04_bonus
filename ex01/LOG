==1865674== Memcheck, a memory error detector
==1865674== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==1865674== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==1865674== Command: ./brain_test
==1865674== 
[33m
=== CPP04 Exercise 01: I donâ€™t want to set the world on fire. ===[0m
1: Subject Required Basic Test                        èª²é¡Œæ›¸è¦æ±‚ã®åŸºæœ¬ãƒ†ã‚¹ãƒˆ
2: Deep Copy Test                                     ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ãƒ†ã‚¹ãƒˆ
3: Virtualæ¬ å¦‚å•é¡Œã®å®Ÿè¨¼                              Virtual polymorphism failure
4: æµ…ã„ã‚³ãƒ”ãƒ¼å•é¡Œã®å®Ÿè¨¼ (WrongDog)                    Shallow copy problem
5: Wrongç³»æµ…ã„ã‚³ãƒ”ãƒ¼è©³ç´°å®Ÿè¨¼                          Wrong shallow copy detailed
6: Assignment Operator Test                           ä»£å…¥æ¼”ç®—å­ãƒ†ã‚¹ãƒˆ
7: Exception Handling Test                            ä¾‹å¤–å‡¦ç†ãƒ†ã‚¹ãƒˆ
0: Exit                                               çµ‚äº†
é¸æŠã—ã¦ãã ã•ã„: [31m=== 4: æµ…ã„ã‚³ãƒ”ãƒ¼å•é¡Œã®å®Ÿè¨¼ (WrongDog) ===[0m
WrongDogã¯æ„å›³çš„ã«æµ…ã„ã‚³ãƒ”ãƒ¼å®Ÿè£…ã«ãªã£ã¦ã„ã¾ã™ï¼

----- âœ… æ­£å¸¸ãªDeep Copy (Cat) -----
[1;32mExecuting: Cat cat1;[0m
[34mAnimal parameterized constructor called[0m
type: Cat, this: 0x1ffefffae0
[33mCat default constructor called           this: 0x1ffefffae0[0m
[36mBrain default constructor called         this: 0x4de5100[0m

[1;32mExecuting: cat1.getBrain()->setIdea(0, "Original cat idea");[0m

Cat1 brain address: 0x4de5100

[1;32mExecuting: Cat cat2(cat1);  // Deep copy[0m
[34mAnimal copy constructor called[0m
type: Cat, this: 0x1ffefffa78
[33mCat copy constructor called              this: 0x1ffefffa78[0m
[36mBrain copy constructor called            this: 0x4de5e80[0m

Cat2 brain address: 0x4de5e80
âœ… Deep copy: ç•°ãªã‚‹Brainã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

[1;32mExecuting: cat2.getBrain()->setIdea(0, "Modified by cat2");[0m
Cat1 idea[0]: "Original cat idea"
Cat2 idea[0]: "Modified by cat2"
âœ… ç‹¬ç«‹ã—ãŸBrainï¼šãŠäº’ã„ã«å½±éŸ¿ãªã—


[33mCat destructor called                   this: 0x1ffefffa78[0m
[36mBrain destructor called                 this: 0x4de5e80[0m
[34mAnimal destructor called[0m
type: Cat, this: 0x1ffefffa78
[33mCat destructor called                   this: 0x1ffefffae0[0m
[36mBrain destructor called                 this: 0x4de5100[0m
[34mAnimal destructor called[0m
type: Cat, this: 0x1ffefffae0

----- ğŸ”´ å•é¡Œã®ã‚ã‚‹Shallow Copy (WrongDog) -----
[1;32mExecuting: WrongDog dog1;[0m
[35mWrongAnimal parameterized constructor called this: 0x1ffefff9e8[0m
[36mWrongDog default constructor called     this: 0x1ffefff9e8[0m
[31mWrongBrain default constructor called   this: 0x4de6cc0[0m

[1;32mExecuting: dog1.getBrain().setIdea(0, "Original dog idea");[0m

WrongDog1 brain address: 0x4de6cc0

[1;32mExecuting: WrongDog dog2(dog1);  // CAUTION Shallow copy![0m
[35mWrongAnimal copy constructor called     this: 0x1ffefff998[0m
[36mWrongDog copy constructor called        this: 0x1ffefff998[0m
[36m  âš ï¸  SHALLOW COPY: brain pointer copied from 0x4de6cc0[0m

WrongDog2 brain address: 0x4de6cc0
âŒ Shallow copy: åŒã˜Brainã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å…±æœ‰ï¼

[1;32mExecuting: dog2.getBrain().setIdea(0, "Modified by dog2");[0m
WrongDog1 idea[0]: "Modified by dog2"
WrongDog2 idea[0]: "Modified by dog2"
âŒ å±é™ºï¼šdog1ã®ideaã‚‚dog2ã«ã‚ˆã£ã¦å¤‰æ›´ã•ã‚ŒãŸï¼

ğŸš¨ ã“ã®å¾Œã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å‡ºã‚‹ã¨ãã«double deleteãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™...
dog1ã¨dog2ã®ä¸¡æ–¹ãŒåŒã˜brainãƒã‚¤ãƒ³ã‚¿ã‚’å‰Šé™¤ã—ã‚ˆã†ã¨ã—ã¾ã™ï¼

[36mWrongDog destructor called             this: 0x1ffefff998[0m
[31mWrongBrain destructor called            this: 0x4de6cc0[0m
[35mWrongAnimal destructor called           this: 0x1ffefff998[0m
[36mWrongDog destructor called             this: 0x1ffefff9e8[0m
[31mWrongBrain destructor called            this: 0x4de6cc0[0m
==1865674== Invalid read of size 8
==1865674==    at 0x49BD474: std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string() (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==1865674==    by 0x40D71D: WrongBrain::~WrongBrain() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x40D11D: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406557: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Address 0x4de7920 is 3,168 bytes inside a block of size 3,200 free'd
==1865674==    at 0x484B8AF: operator delete(void*) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40D12B: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406546: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Block was alloc'd at
==1865674==    at 0x4849013: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40CD1C: WrongDog::WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x405DAF: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674== 
==1865674== Invalid free() / delete / delete[] / realloc()
==1865674==    at 0x484B8AF: operator delete(void*) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40D71D: WrongBrain::~WrongBrain() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x40D11D: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406557: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Address 0x4de79e0 is 0 bytes inside a block of size 31 free'd
==1865674==    at 0x484B8AF: operator delete(void*) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40D71D: WrongBrain::~WrongBrain() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x40D11D: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406546: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Block was alloc'd at
==1865674==    at 0x4849013: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x49BCFEE: std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==1865674==    by 0x49BD4AC: std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::operator=(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.30)
==1865674==    by 0x40D9B0: WrongBrain::setIdea(int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x405E9B: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674== 
==1865674== Invalid free() / delete / delete[] / realloc()
==1865674==    at 0x484B8AF: operator delete(void*) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40D12B: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406557: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Address 0x4de6cc0 is 0 bytes inside a block of size 3,200 free'd
==1865674==    at 0x484B8AF: operator delete(void*) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40D12B: WrongDog::~WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x406546: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==  Block was alloc'd at
==1865674==    at 0x4849013: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
==1865674==    by 0x40CD1C: WrongDog::WrongDog() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x405DAF: testShallowCopyProblem() (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674==    by 0x402C4E: main (in /home/torinoue/tmp/REV_CPP04/ex01/brain_test)
==1865674== 
[35mWrongAnimal destructor called           this: 0x1ffefff9e8[0m


ğŸ“š å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:
ãƒ»æµ…ã„ã‚³ãƒ”ãƒ¼ã§ã¯è¤‡æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåŒã˜ãƒªã‚½ãƒ¼ã‚¹ã‚’å…±æœ‰
ãƒ»ä¸€æ–¹ã®å¤‰æ›´ãŒä»–æ–¹ã«å½±éŸ¿ã™ã‚‹
ãƒ»double deleteã‚¨ãƒ©ãƒ¼ã®ãƒªã‚¹ã‚¯
ãƒ»èª²é¡Œæ›¸è¦æ±‚ï¼šã€ŒA copy of a Dog or a Cat mustn't be shallowã€
[33m
=== CPP04 Exercise 01: I donâ€™t want to set the world on fire. ===[0m
1: Subject Required Basic Test                        èª²é¡Œæ›¸è¦æ±‚ã®åŸºæœ¬ãƒ†ã‚¹ãƒˆ
2: Deep Copy Test                                     ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ãƒ†ã‚¹ãƒˆ
3: Virtualæ¬ å¦‚å•é¡Œã®å®Ÿè¨¼                              Virtual polymorphism failure
4: æµ…ã„ã‚³ãƒ”ãƒ¼å•é¡Œã®å®Ÿè¨¼ (WrongDog)                    Shallow copy problem
5: Wrongç³»æµ…ã„ã‚³ãƒ”ãƒ¼è©³ç´°å®Ÿè¨¼                          Wrong shallow copy detailed
6: Assignment Operator Test                           ä»£å…¥æ¼”ç®—å­ãƒ†ã‚¹ãƒˆ
7: Exception Handling Test                            ä¾‹å¤–å‡¦ç†ãƒ†ã‚¹ãƒˆ
0: Exit                                               çµ‚äº†
é¸æŠã—ã¦ãã ã•ã„: ==1865674== 
==1865674== HEAP SUMMARY:
==1865674==     in use at exit: 0 bytes in 0 blocks
==1865674==   total heap usage: 17 allocs, 19 frees, 87,656 bytes allocated
==1865674== 
==1865674== All heap blocks were freed -- no leaks are possible
==1865674== 
==1865674== For lists of detected and suppressed errors, rerun with: -s
==1865674== ERROR SUMMARY: 102 errors from 3 contexts (suppressed: 0 from 0)
